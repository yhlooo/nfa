# 网络搜索 (Web Search)

NFA 支持通过网络搜索工具获取最新信息，扩展 Agent 的知识范围。

## 概述

WebSearch 工具允许 Agent 在需要时主动搜索互联网，获取最新的资讯、新闻和数据。这对于以下场景特别有用：

- **信息查询** - 查询最新的股票价格、市场资讯
- **事实验证** - 验证用户提供的信息是否准确
- **新闻跟踪** - 获取特定公司或行业的最新动态
- **研究分析** - 收集深度分析所需的背景信息

Agent 会根据对话上下文自动判断是否需要使用搜索工具，用户无需手动触发。

## 配置方式

WebSearch 工具使用腾讯云 Web Search Agent (WSA) 服务，需要在配置文件中进行配置。

### 配置位置

配置文件位于 `~/.nfa/nfa.json`，在 `dataProviders` 数组中添加腾讯云 WSA 配置：

```json
{
  "modelProviders": [...],
  "defaultModels": {...},
  "dataProviders": [
    {
      "tcloudWSA": {
        "secretID": "your-tencent-secret-id",
        "secretKey": "your-tencent-secret-key",
        "endpoint": ""
      }
    }
  ]
}
```

### 配置参数说明

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| `secretID` | string | 是 | 腾讯云访问密钥 ID |
| `secretKey` | string | 是 | 腾讯云访问密钥 |
| `endpoint` | string | 否 | 自定义服务端点，留空使用默认端点 |

### 获取腾讯云凭证

1. 访问 [腾讯云控制台](https://console.cloud.tencent.com/)
2. 登录后进入「访问管理」→「API 密钥管理」
3. 创建或查看现有的 SecretID 和 SecretKey

## 工具输入输出

### 输入格式

```json
{
  "query": "搜索关键词"
}
```

### 输出格式

```json
{
  "items": [
    {
      "title": "页面标题",
      "description": "页面描述内容",
      "date": "2024-01-01T00:00:00Z",
      "url": "https://example.com/article",
      "site": "example.com"
    }
  ]
}
```

## 使用场景

### 场景 1：查询实时信息

当用户询问最新的市场资讯或新闻时，Agent 会自动调用搜索工具：

```
用户：最近特斯拉有什么新闻？
```

Agent 会搜索"特斯拉 最新新闻"，并根据搜索结果整理回答。

### 场景 2：事实验证

当用户提供了具体的信息时，Agent 可以通过搜索验证：

```
用户：苹果公司的市盈率是多少？
```

Agent 可以搜索最新的财务数据来回答。

### 场景 3：背景研究

对于需要大量背景信息的复杂问题：

```
用户：分析一下人工智能行业的投资机会
```

Agent 可以多次搜索不同角度的信息，然后进行综合分析。

## 注意事项

1. **API 配额** - 腾讯云 WSA 服务有调用配额限制，注意监控使用量

2. **搜索延迟** - 网络搜索需要额外的网络请求，响应时间会比纯本地计算稍长

3. **信息时效性** - 搜索结果反映的是网络上的信息，Agent 需要判断信息的准确性和时效性

4. **工具调用策略** - Agent 会根据系统提示中的规则判断是否需要搜索：
   - 如果已有信息足以回答问题，直接回答
   - 避免不必要的搜索调用
   - 优先使用已有工具获取的数据

## 与其他工具的配合

WebSearch 工具可以与 NFA 的其他工具配合使用：

- **Alpha Vantage** - 获取精确的金融数据后，用搜索补充背景信息
- **WebBrowse** - 搜索发现相关网页后，可以进一步浏览具体内容
- **自定义技能** - 技能可以包含搜索指令，实现更复杂的自动化流程

## 故障排查

### 搜索工具未生效

检查以下几点：

1. 配置文件中 `tcloudWSA` 部分是否正确填写
2. SecretID 和 SecretKey 是否有效
3. 网络连接是否正常
4. 查看 `~/.nfa/nfa.log` 日志文件中的错误信息

### 搜索结果不准确

- 尝试调整搜索关键词的表达方式
- Agent 可能需要多轮对话来明确你的需求
- 检查搜索结果的发布日期，确认信息是否过时
